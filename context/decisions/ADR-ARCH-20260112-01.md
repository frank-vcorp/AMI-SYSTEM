# ADR-ARCH-20260112-01: Arquitectura Modular AMI-SYSTEM

**Estado:** Aceptada

**Fecha:** 2026-01-12

**Autores:** INTEGRA (Arquitecto IA)

**Stakeholders:** FRANK (Director), SOFIA (Constructora), GEMINI (Infraestructura)

**Etiquetas:** `#arquitectura` `#modular` `#core` `#extensibilidad`

---

## Contexto

- **Problema:** AMI-SYSTEM necesita una arquitectura que permita:
  1. MÃ³dulos independientes que puedan reutilizarse en otros proyectos
  2. Agregar nuevos mÃ³dulos en el futuro (Wellness, Salud Mental, etc.)
  3. Integrar sistemas externos (NOVA, SIM, CONTPAQi)
  4. Soportar mÃºltiples clÃ­nicas con diferentes capacidades
  5. Funcionar como PWA responsive para mÃ³viles

- **Contexto del Negocio:** 
  - AMI opera mÃºltiples clÃ­nicas de salud ocupacional
  - Cada empresa cliente tiene diferentes baterÃ­as de estudios contratadas
  - El flujo paciente es: Cita â†’ Check-in â†’ Examen â†’ Estudios â†’ ValidaciÃ³n â†’ Entrega
  - Se requiere IA para extracciÃ³n de datos de PDFs mÃ©dicos

- **Restricciones:**
  - Presupuesto limitado (usar servicios managed cuando sea posible)
  - Equipo pequeÃ±o (arquitectura simple pero extensible)
  - El sistema debe estar operativo en fases incrementales

- **Fuerzas:**
  - Modularidad vs Complejidad inicial
  - Independencia de mÃ³dulos vs IntegraciÃ³n fluida
  - Mobile-first vs Desktop productivity

---

## DecisiÃ³n

**Hemos decidido implementar una arquitectura modular basada en monorepo con paquetes independientes.**

### Estructura Principal

```
ami-system/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ core/                    â† Servicios compartidos
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ storage/
â”‚   â”‚   â”œâ”€â”€ notifications/
â”‚   â”‚   â””â”€â”€ ui/
â”‚   â”‚
â”‚   â”œâ”€â”€ mod-clinicas/            â† MÃ³dulos independientes
â”‚   â”œâ”€â”€ mod-servicios/
â”‚   â”œâ”€â”€ mod-citas/
â”‚   â”œâ”€â”€ mod-expedientes/
â”‚   â”œâ”€â”€ mod-validacion/
â”‚   â””â”€â”€ ... (futuros)
â”‚
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                     â† App principal Next.js
â”‚   â””â”€â”€ api/                     â† API routes
â”‚
â”œâ”€â”€ integrations/
â”‚   â”œâ”€â”€ nova-adapter/            â† Laboratorio externo
â”‚   â””â”€â”€ sim-adapter/             â† Equipos gabinete
â”‚
â””â”€â”€ docs/
```

### Principios de DiseÃ±o

1. **Cada mÃ³dulo es independiente**: Puede funcionar solo con Core
2. **ComunicaciÃ³n por interfaces**: MÃ³dulos no se importan directamente
3. **Core es el pegamento**: Auth, DB, Storage compartidos
4. **PWA-first**: UI responsive desde el inicio

---

## Alternativas Consideradas

### Alternativa 1: Monolito tradicional

**DescripciÃ³n:** Todo en una sola app Next.js sin separaciÃ³n de mÃ³dulos.

**Pros:**
- âœ… MÃ¡s simple de iniciar
- âœ… Menos configuraciÃ³n

**Contras:**
- âŒ DifÃ­cil extraer mÃ³dulos para otros proyectos
- âŒ CÃ³digo acoplado, difÃ­cil de mantener
- âŒ No cumple requisito de "mod-citas independiente"

**RazÃ³n del Descarte:** No permite reutilizaciÃ³n de mÃ³dulos.

### Alternativa 2: Microservicios completos

**DescripciÃ³n:** Cada mÃ³dulo como servicio separado con su propia DB.

**Pros:**
- âœ… MÃ¡xima independencia
- âœ… Escala individual

**Contras:**
- âŒ Complejidad operativa excesiva
- âŒ Costo de infraestructura alto
- âŒ Overhead de comunicaciÃ³n entre servicios

**RazÃ³n del Descarte:** SobreingenierÃ­a para el tamaÃ±o actual del equipo.

---

## Consecuencias

### Positivas
- âœ… MÃ³dulos reutilizables en otros proyectos de FRANK
- âœ… FÃ¡cil agregar Wellness, Mental Health, etc.
- âœ… Testing aislado por mÃ³dulo
- âœ… Onboarding claro para nuevos desarrolladores

### Negativas
- âš ï¸ ConfiguraciÃ³n inicial mÃ¡s compleja que monolito
- âš ï¸ Requiere disciplina para mantener interfaces claras

### Riesgos
- Si no se documenta bien, futuros devs podrÃ­an romper la modularidad

---

## Referencias

- [ARCH-20260112-02](ADR-ARCH-20260112-02.md) - Stack TecnolÃ³gico
- [ARCH-20260112-03](ADR-ARCH-20260112-03.md) - Modelo de Datos
- `context/00_CHECKLIST_LEGACY_CONSOLIDADO.md` - Assets del legacy

---

**ğŸ—ï¸ ARCH REFERENCE:** ARCH-20260112-01  
**ğŸ¤– AUTHOR:** INTEGRA (Arquitecto IA)
